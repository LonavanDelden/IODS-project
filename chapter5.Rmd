# 5. Dimensionality reduction techniques

- Data overview

Here are my header explanations:

- "GNI" = Gross National Income per capita
- "life" = Life expectancy at birth
- "exp_edu" = Expected years of schooling
- "mat.mor_rat" = Maternal mortality ratio
- "birth.rate" = Adolescent birth rate
- "par.repr" = Percetange of female representatives in parliament
- "f_m.sec_edu" = f.sec_edu / m.sec_edu
- "f_m.labour" = f.labour / m.labour

["f.sec_edu" = Proportion of females with at least secondary education
"m.sec_edu" = Proportion of males with at least secondary education
"f.labour" = Proportion of females in the labour force
"m.labour" = Proportion of males in the labour force]

The summary shows that the observations are spreading across various scales, this suggests a standardization application later on to compare them in further analysis. The pairs graphs show that some of the variables have normally distributed observations, some do not (e.g. GNI). The stongest (negative) relationship can be found between maternal mortality ratio (mat.mor_rat) and life expectancy at birth (life), quite logically when the mortality ratio increases the life expectancy decreases. Strong positive relationships can be found between mortality ratio and birth rate as well as life expectancy and expected years of schooling (exp_edu), which is a little less obvious. Overall education seems to have a stronger influence on life expectancy, birth rate, moratlity rate etc. than labour related factors. 

```{r human, echo=TRUE, results='markup', message=FALSE, warning=FALSE}
library(openxlsx)
library(tidyr)
library(dplyr)
library(GGally)
library(corrplot)
library(ggfortify)
human <- read.csv("human.csv", sep = ",", header = TRUE)
dim(human)
str(human)
colnames(human)
summary(human)
ggpairs(human)
cor(human) %>% corrplot(type = "upper")
```

- PCA on unstandardized data

The difference between the PCA of standardized and unstandardized data is the distribution of the ploted data, which makes PC1 the sole explaining component in the unstandardized data. 

```{r PCA_no scale, echo=TRUE, results='markup', message=FALSE, warning=FALSE}
pca_human <- prcomp(human)
s <- summary(pca_human)
s
pca_pr <- round(100*s$importance[2, ], digits = 1)
pca_pr
pc_lab <- paste0(names(pca_pr),  " (", pca_pr, "%)")
biplot(pca_human, cex = c(0.8, 1), col = c("grey40", "deeppink2"), xlab = pc_lab[1], ylab = pc_lab[2])
```

- PCA on standardized data

The PCA on the standardized data identifies more individual parameters which reduces the PC1 effect to about 54%, which is still the majority. Now the original variables can be identified to be 

```{r PCA_scaled, echo=TRUE, results='markup', message=FALSE, warning=FALSE}
human_std <- scale(human)
summary(human_std)
pca_human <- prcomp(human_std)
s <- summary(pca_human)
s
pca_pr <- round(100*s$importance[2, ], digits = 1)
pca_pr
pc_lab <- paste0(names(pca_pr),  " (", pca_pr, "%)")
biplot(pca_human, cex = c(0.8, 1), col = c("grey40", "deeppink2"), xlab = pc_lab[1], ylab = pc_lab[2])
```

Caption: 
GNI = Gross National Income per capita, life = Life expectancy at birth, exp_edu = Expected years of schooling, mat.mor_rat = Maternal mortality ratio, birth.rate = Adolescent birth rate, par.repr = Percetange of female representatives in parliament, f_m.sec_edu = Ratio of females to males with at least secondary education, f_m.labour = Ratio of females to males in the labour force

- MCA

```{r tea, echo=TRUE, results='markup', message=FALSE, warning=FALSE}
library(FactoMineR)
data("tea")
str(tea)
dim(tea)
keep_columns <- c("Tea", "How", "how", "sugar", "where", "lunch")
tea_time <- select(tea, one_of(keep_columns))
gather(tea_time) %>% ggplot(aes(value)) + geom_bar() + facet_wrap("key", scales = "free") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) 
```


```{r MCA, echo=TRUE, results='markup', message=FALSE, warning=FALSE}
mca <- MCA(tea_time, graph = FALSE)
summary(mca)
plot(tea_time, invisible=c("ind"), habillage = "quali")
```
